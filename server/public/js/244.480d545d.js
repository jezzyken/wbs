"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[244],{4798:function(e,t,s){s.r(t),s.d(t,{default:function(){return T}});var i=s(6103),a=s(7314),r=s(3698),n=s(2938),o=s(4414),l=s(3449),d=s(3064),c=s(1289),u=s(174),h=s(6930),p=s(2756),m=s(4312),x=s(7150),f=s(1034),v=s(7112),g=s(6513),b=function(){var e=this,t=e._self._c;return t(l.A,{staticClass:"px-6"},[t("div",{staticClass:"mb-6"},[t(i.A,{staticClass:"pa-0",attrs:{items:e.breadcrumbs,divider:"/"}})],1),t(r.A,{staticClass:"mb-6"},[t(n.OQ,[t(p.A,[t(o.A,{attrs:{cols:"12",sm:"6",md:"4"}},[t(v.A,{attrs:{label:"Search",placeholder:"Description / Type",dense:"",outlined:"","hide-details":"","prepend-inner-icon":"mdi-magnify"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),t(f.A)],1)],1)],1),t(r.A,[t(n.ri,{staticClass:"d-flex justify-space-between py-4"},[t("span",{staticClass:"text-h6"},[e._v("Expenses List")]),t("div",[t(a.A,{attrs:{color:"primary"},on:{click:e.openAddDialog}},[t(h.A,{attrs:{left:""}},[e._v("mdi-plus")]),e._v(" Add Expense ")],1)],1)]),t(d.A,{attrs:{headers:e.headers,items:e.filteredExpenses,loading:e.loading,"items-per-page":10,"footer-props":{"items-per-page-options":[10,20,50],"show-first-last-page":!0}},scopedSlots:e._u([{key:"item.amount",fn:function({item:t}){return[e._v(" ₱"+e._s(t.amount.toFixed(2))+" ")]}},{key:"item.date",fn:function({item:t}){return[e._v(" "+e._s(e.formatDate(t.date))+" ")]}},{key:"item.actions",fn:function({item:s}){return[t(a.A,{staticClass:"mr-2",attrs:{"x-small":"",text:"",color:"primary"},on:{click:function(t){return e.editExpense(s)}}},[t(h.A,{attrs:{"x-small":"",left:""}},[e._v("mdi-pencil")]),e._v(" Edit ")],1),"admin"===e.userRole?t(a.A,{attrs:{"x-small":"",text:"",color:"error"},on:{click:function(t){return e.onDeleteExpenses(s)}}},[t(h.A,{attrs:{"x-small":"",left:""}},[e._v("mdi-delete")]),e._v(" Delete ")],1):e._e()]}}])})],1),t(c.A,{attrs:{"max-width":"600px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[t(r.A,[t(n.ri,[t("span",{staticClass:"text-h5"},[e._v(e._s(e.isEdit?"Edit Expense":"Add Expense"))])]),t(n.OQ,[e.dialog?t(u.A,{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t(p.A,[t(o.A,{attrs:{cols:"12",sm:"6"}},[t(v.A,{attrs:{label:"Date",type:"date",required:"",rules:e.requiredRules},model:{value:e.editedItem.date,callback:function(t){e.$set(e.editedItem,"date",t)},expression:"editedItem.date"}})],1),t(o.A,{attrs:{cols:"12",sm:"6"}},[t(v.A,{attrs:{label:"Amount",type:"number",prefix:"₱",required:"",rules:e.amountRules},model:{value:e.editedItem.amount,callback:function(t){e.$set(e.editedItem,"amount",e._n(t))},expression:"editedItem.amount"}})],1),t(o.A,{attrs:{cols:"12",sm:"12"}},[t(m.A,{attrs:{items:e.expenseTypes,label:"Expense Type",required:"",rules:e.requiredRules},model:{value:e.editedItem.expenseType,callback:function(t){e.$set(e.editedItem,"expenseType",t)},expression:"editedItem.expenseType"}})],1),t(o.A,{attrs:{cols:"12"}},[t(g.A,{attrs:{label:"Description",required:"",rules:e.requiredRules},model:{value:e.editedItem.description,callback:function(t){e.$set(e.editedItem,"description",t)},expression:"editedItem.description"}})],1)],1)],1):e._e()],1),t(n.SL,[t(f.A),t(a.A,{attrs:{text:"",disabled:e.isSaving},on:{click:e.closeDialog}},[e._v("Cancel")]),t(a.A,{attrs:{color:"primary",disabled:!e.valid||e.isSaving,loading:e.isSaving},on:{click:e.saveExpense}},[e._v(" Save ")])],1)],1)],1),t(c.A,{attrs:{"max-width":"400px"},model:{value:e.confirmDialog,callback:function(t){e.confirmDialog=t},expression:"confirmDialog"}},[t(r.A,[t(n.ri,{staticClass:"text-h5"},[e._v("Confirm Delete")]),t(n.OQ,[e._v("Are you sure you want to delete this expense?")]),t(n.SL,[t(f.A),t(a.A,{attrs:{text:""},on:{click:function(t){e.confirmDialog=!1}}},[e._v("Cancel")]),t(a.A,{attrs:{color:"error",text:""},on:{click:e.confirmDelete}},[e._v("Delete")])],1)],1)],1),t(x.A,{attrs:{color:e.snackbarColor,timeout:"3000"},scopedSlots:e._u([{key:"action",fn:function({attrs:s}){return[t(a.A,e._b({attrs:{text:""},on:{click:function(t){e.snackbar=!1}}},"v-btn",s,!1),[e._v("Close")])]}}]),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(" "+e._s(e.snackbarText)+" ")])],1)},A=[],y=(s(8111),s(2489),s(5353)),k=s(5093),w=s.n(k),_={name:"ExpensesPage",data:()=>({breadcrumbs:[{text:"Home",disabled:!1,href:"/"},{text:"Expenses",disabled:!0}],search:"",dialog:!1,confirmDialog:!1,dateMenu:!1,valid:!1,isEdit:!1,snackbar:!1,snackbarText:"",snackbarColor:"",isSaving:!1,itemToDelete:null,headers:[{text:"Date",value:"date",sortable:!0},{text:"Amount",value:"amount",sortable:!0},{text:"Type",value:"expenseType",sortable:!0},{text:"Description",value:"description",sortable:!0},{text:"Actions",value:"actions",sortable:!1}],expenseTypes:["Utilities","Supplies","Maintenance","Other"],editedItem:{date:w()().format("YYYY-MM-DD"),amount:0,expenseType:"",description:""},defaultItem:{date:w()().format("YYYY-MM-DD"),amount:0,expenseType:"",description:""},requiredRules:[e=>!!e||"This field is required"],amountRules:[e=>!!e||"Amount is required",e=>e>0||"Amount must be greater than 0"]}),computed:{...(0,y.aH)("expenses",["expenses","loading","error"]),userRole(){return this.$store.state.auth.user?.role},filteredExpenses(){return this.expenses.filter((e=>{const t=this.search.toLowerCase();return!this.search||e.description.toLowerCase().includes(t)||e.expenseType.toLowerCase().includes(t)}))}},async created(){await this.fetchExpenses()},methods:{...(0,y.i0)("expenses",["fetchExpenses","createExpense","updateExpense","deleteExpense"]),formatDate(e){return e?w()(e).format("MMM DD, YYYY"):""},openAddDialog(){this.isEdit=!1,this.editedItem={...this.defaultItem},this.dialog=!0},editExpense(e){this.isEdit=!0,this.editedItem={...e,date:w()(e.date).format("YYYY-MM-DD")},this.dialog=!0},closeDialog(){this.dialog=!1,this.$nextTick((()=>{this.$refs.form&&(this.$refs.form.resetValidation(),this.$refs.form.reset()),this.editedItem={...this.defaultItem}}))},async saveExpense(){if(this.$refs.form.validate()){this.isSaving=!0;try{const e={...this.editedItem,date:w()(this.editedItem.date).format("YYYY-MM-DD")};this.isEdit?(await this.updateExpense({id:this.editedItem._id,expense:e}),this.snackbarText="Expense updated successfully"):(await this.createExpense(e),this.snackbarText="Expense created successfully"),this.snackbarColor="success",this.closeDialog(),await this.fetchExpenses()}catch(e){this.snackbarText=e.message||"Error saving expense",this.snackbarColor="error"}finally{this.isSaving=!1,this.snackbar=!0}}},onDeleteExpenses(e){this.itemToDelete=e,this.confirmDialog=!0},async confirmDelete(){try{console.log("Deleting expense with ID:",this.itemToDelete._id),await this.deleteExpense(this.itemToDelete._id),this.snackbarText="Expense deleted successfully",this.snackbarColor="success",await this.fetchExpenses()}catch(e){this.snackbarText=e.message||"Error deleting expense",this.snackbarColor="error"}finally{this.confirmDialog=!1,this.itemToDelete=null,this.snackbar=!0}}}},D=_,E=s(1656),I=(0,E.A)(D,b,A,!1,null,"41839cab",null),T=I.exports},174:function(e,t,s){s(4114),s(8111),s(2489),s(116),s(7588);var i=s(5803),a=s(7717),r=s(7540),n=s(4152);t.A=(0,i.A)(a.A,(0,r.G)("form")).extend({name:"v-form",provide(){return{form:this}},inheritAttrs:!1,props:{disabled:Boolean,lazyValidation:Boolean,readonly:Boolean,value:Boolean},data:()=>({inputs:[],watchers:[],errorBag:{}}),watch:{errorBag:{handler(e){const t=Object.values(e).includes(!0);this.$emit("input",!t)},deep:!0,immediate:!0}},methods:{watchInput(e){const t=e=>e.$watch("hasError",(t=>{this.$set(this.errorBag,e._uid,t)}),{immediate:!0}),s={_uid:e._uid,valid:()=>{},shouldValidate:()=>{}};return this.lazyValidation?s.shouldValidate=e.$watch("shouldValidate",(i=>{i&&(this.errorBag.hasOwnProperty(e._uid)||(s.valid=t(e)))})):s.valid=t(e),s},validate(){return 0===this.inputs.filter((e=>!e.validate(!0))).length},reset(){this.inputs.forEach((e=>e.reset())),this.resetErrorBag()},resetErrorBag(){this.lazyValidation&&setTimeout((()=>{this.errorBag={}}),0)},resetValidation(){this.inputs.forEach((e=>e.resetValidation())),this.resetErrorBag()},register(e){this.inputs.push(e),this.watchers.push(this.watchInput(e))},unregister(e){const t=this.inputs.find((t=>t._uid===e._uid));if(!t)return;const s=this.watchers.find((e=>e._uid===t._uid));s&&(s.valid(),s.shouldValidate()),this.watchers=this.watchers.filter((e=>e._uid!==t._uid)),this.inputs=this.inputs.filter((e=>e._uid!==t._uid)),this.$delete(this.errorBag,t._uid)}},render(e){return e("form",{staticClass:"v-form",attrs:{novalidate:!0,...this.attrs$},on:{submit:e=>this.$emit("submit",e)}},(0,n.$c)(this))}})},6513:function(e,t,s){s.d(t,{A:function(){return n}});var i=s(7112),a=s(5803);const r=(0,a.A)(i.A);var n=r.extend({name:"v-textarea",props:{autoGrow:Boolean,noResize:Boolean,rowHeight:{type:[Number,String],default:24,validator:e=>!isNaN(parseFloat(e))},rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseInt(e,10))}},computed:{classes(){return{"v-textarea":!0,"v-textarea--auto-grow":this.autoGrow,"v-textarea--no-resize":this.noResizeHandle,...i.A.options.computed.classes.call(this)}},noResizeHandle(){return this.noResize||this.autoGrow}},watch:{autoGrow(e){this.$nextTick((()=>{var t;e?this.calculateInputHeight():null===(t=this.$refs.input)||void 0===t||t.style.removeProperty("height")}))},lazyValue(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)},rowHeight(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)}},mounted(){setTimeout((()=>{this.autoGrow&&this.calculateInputHeight()}),0)},methods:{calculateInputHeight(){const e=this.$refs.input;if(!e)return;e.style.height="0";const t=e.scrollHeight,s=parseInt(this.rows,10)*parseFloat(this.rowHeight);e.style.height=Math.max(s,t)+"px"},genInput(){const e=i.A.options.methods.genInput.call(this);return e.tag="textarea",delete e.data.attrs.type,e.data.attrs.rows=this.rows,e},onInput(e){i.A.options.methods.onInput.call(this,e),this.autoGrow&&this.calculateInputHeight()},onKeyDown(e){this.isFocused&&13===e.keyCode&&e.stopPropagation(),this.$emit("keydown",e)}}})}}]);
//# sourceMappingURL=244.480d545d.js.map